# 用户意图分类系统

本项目旨在通过清洗用户数据并使用 Embedding 模型（`BAAI/bge-base-en-v1.5`）对用户的意图进行分类，从而准确响应用户询问。通过数据清洗、聚类和向量检索等步骤，我们实现了对用户问题的高效分类。

## 方案概述

### 1. 数据清洗

为保证数据质量，项目首先对原始用户数据进行了清洗，具体包括以下步骤：
- **重复数据删除**：移除完全相同的用户提问，避免冗余数据影响模型表现。
- **删除重复 token 过高的数据**：排除那些词语（token）重复率过高的数据，因为这些数据往往无意义或噪声较大。
- **删除 token 数量非常短的数据**：短文本通常缺乏足够的上下文信息，不适合作为输入。因此，删除 token 过短的数据，以确保模型能有效提取语义。

通过上述清洗步骤，生成了较为干净的数据集，能够为后续的建模提供良好基础。

### 2. Embedding 向量生成

在获得清洗后的数据后，我们使用 `BAAI/bge-base-en-v1.5` 模型生成了文本的 Embedding 向量。这些向量表示文本的高维语义，能够捕捉用户提问之间的语义相似性。

### 3. 数据聚类

利用 Embedding 向量对用户提问进行聚类分析，归纳出不同的用户意图类别。我们尝试了三种聚类方法，最终选择了 KMeans 作为最佳聚类方案。以下是各类聚类算法的简要说明：

1. **KMeans**：效果最佳，且分类稳定。
2. **层次聚类**：虽然能够自动生成树状结构，但对该任务效果不如 KMeans。
3. **DBSCAN**：适合检测异常数据点，但在本任务中表现不如 KMeans。

最终，通过 KMeans 聚类算法，我们将数据划分为四类：
- **class_select**：关于课程或者职业选择的提问
- **school_cost**：关于学校费用的提问
- **school_life**：关于学校生活的提问
- **teacher_query**：关于教师的提问

### 4. 构建向量库

使用 `llama index` 将清洗后的数据及其所属类别存储为一个向量库。每条记录包含：
- 清洗后的用户提问的 Embedding 向量
- 该提问所属的类别

向量库将作为系统进行意图分类时的主要查询源。

### 5. 用户意图分类

当用户提出新的问题时，系统通过以下步骤进行意图分类：

1. **检索最近的向量**：将用户问题转化为 Embedding 向量，并计算其与向量库中的数据的余弦相似度，选取与当前问题最接近的 5 条记录。
2. **类别投票**：对检索到的 5 条记录所属的类别进行投票，选择得票最多的类别作为当前用户问题的类别。

此分类方法基于数据的语义相似性和投票机制，确保高效且准确地预测用户问题的类别。

## 方案总结

本方案通过数据清洗、Embedding 生成、KMeans 聚类和向量检索技术，建立了一个高效的用户意图分类系统。通过对用户问题的语义分析和分类，系统能够自动识别用户问题的类型并作出准确的响应。

